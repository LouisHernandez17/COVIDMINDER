select(diff))[:,1]
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(diff))[,1]
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(diff))[,1]
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(diff))[1,]
county
yesterday
covid_NY_TS_plot.cases$date[i]
yesterday == as.Date("2020-03-04")
as.Date(yesterday)
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 2:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(diff))[1,]
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 2:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(diff))
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 2:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
print(county)
print(yesterday)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(diff))
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 3:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
print(county)
print(yesterday)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(diff))
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 3:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
print(county)
print(yesterday)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
print(county)
print(yesterday)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
}
covid_NY_TS_plot.cases %>%
filter(diff == numeric(0))
numeric(0)
covid_NY_TS_plot.cases %>%
filter(diff == 0)
covid_NY_TS_plot.cases %>%
filter(is.na)
covid_NY_TS_plot.cases %>%
filter(is.na(diff))
covid_NY_TS_plot.cases %>%
filter(is.numeric(diff))
?is.numeric
is.numeric(1)
is.numeric(numeric(0))
covid_NY_TS_plot.cases$diff
covid_NY_TS_plot.cases$diff[1:10]
covid_NY_TS_plot.cases$diff[1:10] == numeric(0)
numeric(0) == numeric(0)
numeric(1) == numeric(1)
!numeric(0)
!0
!1
length(numeric(0))
length(numeric(1))
length(numeric(2))
length(1)
length(10)
covid_NY_TS_plot.cases %>%
filter(length(diff) == 0)
covid_NY_TS_plot.cases %>%
filter(length(diff) == 1)
covid_NY_TS_plot.cases %>%
filter(length(diff) == 1) %>%
select(diff)
length(covid_NY_TS_plot.cases$diff) == 0
covid_NY_TS_plot.cases %>%
select(diff)
covid_NY_TS_plot.cases %>%
filter(diff.is.empty())
?is_empty
is.empty <- function(x) {return(length(x) == 0)}
covid_NY_TS_plot.cases %>%
filter(is.empty(diff))
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
if (length(covid_NY_TS_plot.cases$diff[i] == 0)) {covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]}
}
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
if (length(covid_NY_TS_plot.cases$diff[i] == 0)) {
print("True")
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]
}
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
if (length(covid_NY_TS_plot.cases$diff[i] == 0)) {
print(covid_NY_TS_plot.cases$diff[i])
print("True")
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]
}
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
if (length(covid_NY_TS_plot.cases$diff[i]) == 0) {
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]
}
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
if (length(covid_NY_TS_plot.cases$diff[i]) == 0) {
print("TRUE")
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]
}
}
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
print(length(covid_NY_TS_plot.cases$diff[i]))
if (length(covid_NY_TS_plot.cases$diff[i]) == 0) {
print("TRUE")
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]
}
}
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
print(length(covid_NY_TS_plot.cases$diff[i][1]))
if (length(covid_NY_TS_plot.cases$diff[i]) == 0) {
print("TRUE")
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]
}
}
covid_NY_TS_plot.cases$diff[i]
covid_NY_TS_plot.cases$diff[1]
length(covid_NY_TS_plot.cases$diff[1])
length(covid_NY_TS_plot.cases$diff[1,])
length(covid_NY_TS_plot.cases$diff[,1])
length(covid_NY_TS_plot.cases$diff[[1]])
length(covid_NY_TS_plot.cases$diff[[2]])
length(covid_NY_TS_plot.cases$diff[[3]])
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
if (length(covid_NY_TS_plot.cases$diff[[i]]) == 0) {
print("TRUE")
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]
}
}
covid_NY_TS_plot.cases <- covid_NY_TS_plot.cases %>%
dplyr::mutate(p_diff = (diff/Population)*100000)
covid_NY_TS_plot.cases <- covid_NY_TS_plot.cases %>%
mutate(p_diff = (diff/Population)*100000)
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases$diff <- covid_NY_TS_plot.cases$cases
covid_NY_TS_plot.cases$p_diff <- covid_NY_TS_plot.cases$p_cases
for(i in 1:nrow(covid_NY_TS_plot.cases)) {
county <- covid_NY_TS_plot.cases$County[i]
yesterday <- as.Date(covid_NY_TS_plot.cases$date[i] - 1)
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(cases))
covid_NY_TS_plot.cases$p_diff[i] <- covid_NY_TS_plot.cases$p_diff[i] -
(covid_NY_TS_plot.cases %>%
filter(County == county & date == yesterday) %>%
select(p_cases))
if (length(covid_NY_TS_plot.cases$diff[[i]]) == 0) {
covid_NY_TS_plot.cases$diff[i] <- covid_NY_TS_plot.cases$cases[i]
}
if (length(covid_NY_TS_plot.cases$p_diff[[i]]) == 0) {
covid_NY_TS_plot.cases$p_diff[i] <- covid_NY_TS_plot.cases$p_cases[i]
}
}
?diff
?lag
?shift
?data.table::shift
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(date - 1 == lag(date), cases - lag(x), cases))
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(x), cases))
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), cases))
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), 0))
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), NA)) ->
covid_NY_TS_plot.cases
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases %>%
filter(is.na(diff))
covid_NY_TS_plot.cases %>%
filter(is.na(diff)) %>%
select(diff) <- cases
covid_NY_TS_plot.cases %>%
select(diff) %>%
replace_na(cases)
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), NA)) %>%
ungroup() -> covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>%
select(diff) %>%
replace_na(cases)
covid_NY_TS_plot.cases %>%
replace_na(cases)
covid_NY_TS_plot.cases %>%
mutate(p_diff = ifelse(as.Date(date - 1) == lag(date), p_cases - lag(p_cases), NA)) ->
covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), NA)) ->
covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>%
mutate(p_diff = ifelse(as.Date(date - 1) == lag(date), p_cases - lag(p_cases), NA)) ->
covid_NY_TS_plot.cases
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases %>%
mutate(p_diff = ifelse(as.Date(date - 1) == lag(date), p_cases - lag(p_cases), NA)) %>%
ungroup() -> covid_NY_TS_plot.cases
?mutate
covid_NY_TS_plot.cases %>%
filter(is.na(diff)) %>%
mutate(diff = cases) %>%
mutate(p_diff = p_cases)
covid_NY_TS_plot.cases %>%
filter(is.na(diff)) %>%
mutate(diff = cases) %>%
mutate(p_diff = p_cases) -> covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), NA)) ->
covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>%
mutate(p_diff = ifelse(as.Date(date - 1) == lag(date), p_cases - lag(p_cases), NA)) %>%
ungroup() -> covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>%
mutate(ifelse(is.na(diff), diff = cases, diff)) %>%
mutate(ifelse(is.na(p_diff), p_diff = p_cases, p_diff))
covid_NY_TS_plot.cases %>%
mutate(ifelse(is.na(diff), cases, diff)) %>%
mutate(ifelse(is.na(p_diff), p_cases, p_diff))
?ifelse
?replace
?replace_na
covid_NY_TS_plot.cases %>%
replace(diff, is.na(diff), cases)
covid_NY_TS_plot.cases %>%
replace(is.na(diff), cases)
covid_NY_TS_plot.cases %>%
replace(., is.na(diff), cases)
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), NA)) ->
covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>%
mutate(p_diff = ifelse(as.Date(date - 1) == lag(date), p_cases - lag(p_cases), NA)) %>%
ungroup() -> covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), NA)) ->
covid_NY_TS_plot.cases
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases <- read_csv("data/csv/time_series/covid_NY_TS_plot.cases.csv")
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), NA)) ->
covid_NY_TS_plot.cases
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases %>%
mutate(p_diff = ifelse(as.Date(date - 1) == lag(date), p_cases - lag(p_cases), NA)) %>%
ungroup() -> covid_NY_TS_plot.cases
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases$diff <- ifelse(is.na(covid_NY_TS_plot.cases$diff), covid_NY_TS_plot.cases$cases, covid_NY_TS_plot.cases$diff)
covid_NY_TS_plot.cases$p_diff <- ifelse(is.na(covid_NY_TS_plot.cases$p_diff), covid_NY_TS_plot.cases$p_cases, covid_NY_TS_plot.cases$p_diff)
covid_NY_TS_plot.cases <- read_csv("data/csv/time_series/covid_NY_TS_plot.cases.csv")
covid_NY_TS_plot.cases %>% group_by(County) %>%
mutate(diff = ifelse(as.Date(date - 1) == lag(date), cases - lag(cases), cases)) ->
covid_NY_TS_plot.cases
covid_NY_TS_plot.cases %>%
mutate(p_diff = ifelse(as.Date(date - 1) == lag(date), p_cases - lag(p_cases), p_cases)) %>%
ungroup() -> covid_NY_TS_plot.cases
View(covid_NY_TS_plot.cases)
covid_NY_TS_plot.cases$diff <- ifelse(is.na(covid_NY_TS_plot.cases$diff), covid_NY_TS_plot.cases$cases, covid_NY_TS_plot.cases$diff)
covid_NY_TS_plot.cases$p_diff <- ifelse(is.na(covid_NY_TS_plot.cases$p_diff), covid_NY_TS_plot.cases$p_cases, covid_NY_TS_plot.cases$p_diff)
library(tidyverse)
owidURL <- "https://covid.ourworldindata.org/data/owid-covid-data.csv"
download.file(owidURL, paste0("data/csv/", "owid_testing_raw.csv"))
todays_raw_owid_data <- read_csv(paste0("data/csv/", "owid_testing_raw.csv"))
View(todays_raw_owid_data)
todays_raw_owid_data %>% filter(iso_code == "DEU") %>%
select(iso_code, location, date, total_tests_per_thousand, new_tests_per_thousand) %>%
slice(which.max(as.Date(date, '%Y-%m-%d')))
todays_raw_owid_data <- todays_raw_owid_data %>%
select(iso_code, location, date, total_tests_per_thousand, new_tests_per_thousand) %>%
drop_na(total_tests_per_thousand, new_tests_per_thousand) %>%
group_by(iso_code) %>%
slice(which.max(as.Date(date, '%Y-%m-%d'))) %>%
arrange(desc(total_tests_per_thousand))
View(todays_raw_owid_data)
check_iso_codes <- c("PRT","ITA","RUS","USA","GBR","CAN","CHE")
check_raw_owid_data <- todays_raw_owid_data %>%
filter(iso_code %in% check_iso_codes)
View(check_raw_owid_data)
# Download states raw data
owidURL <- "https://covid.ourworldindata.org/data/owid-covid-data.csv"
download.file(owidURL, paste0("data/csv/", "owid_testing_raw.csv"))
# Make backup of existing data
write_csv(read_csv("data/csv/state_covid_testing.csv"),"data/csv/owid_covid_testing.csv.bak")
# Import raw into R
todays_raw_owid_data <- read_csv(paste0("data/csv/", "owid_testing_raw.csv"))
# Import raw into R
todays_raw_owid_data <- read_csv(paste0("data/csv/", "owid_testing_raw.csv"))
todays_raw_owid_data %>% filter(!is.na(total_tests_per_thousand))
View(todays_raw_owid_data)
raw_owid_data.total.test.rate <-todays_raw_owid_data %>%
filter(!is.na(total_tests_per_thousand)) %>%
select(iso_code, location, date, total_tests_per_thousand)
View(raw_owid_data.total.test.rate)
raw_owid_data.total.test.rate <-todays_raw_owid_data %>%
filter(!is.na(total_tests_per_thousand) & iso_code %in% check_iso_codes) %>%
select(iso_code, location, date, total_tests_per_thousand)
check_iso_codes <- c("PRT","ITA","RUS","USA","GBR","CAN","CHE", "DEU")
raw_owid_data.total.test.rate <-todays_raw_owid_data %>%
filter(!is.na(total_tests_per_thousand) & iso_code %in% check_iso_codes) %>%
select(iso_code, location, date, total_tests_per_thousand)
View(raw_owid_data.total.test.rate)
raw_owid_data.total.test.rate <-todays_raw_owid_data %>%
filter(!is.na(total_tests_per_thousand) & iso_code %in% check_iso_codes) %>%
select(iso_code, location, date, total_tests_per_thousand) %>%
group_by(iso_code) %>%
filter(date = max(date))
raw_owid_data.total.test.rate <-todays_raw_owid_data %>%
filter(!is.na(total_tests_per_thousand) & iso_code %in% check_iso_codes) %>%
select(iso_code, location, date, total_tests_per_thousand) %>%
group_by(iso_code) %>%
filter(date == max(date))
View(raw_owid_data.total.test.rate)
raw_owid_data.total.test.rate <-todays_raw_owid_data %>%
filter(!is.na(total_tests_per_thousand) & iso_code %in% check_iso_codes) %>%
select(iso_code, location, date, total_tests_per_thousand) %>%
group_by(iso_code) %>%
filter(date == max(date)) %>%
top_n(n=1)
View(raw_owid_data.total.test.rate)
owid_data.total.test.rate <-todays_raw_owid_data %>%
filter(!is.na(total_tests_per_thousand) & iso_code %in% check_iso_codes) %>%
select(iso_code, location, date, total_tests_per_thousand) %>%
group_by(iso_code) %>%
filter(date == max(date)) %>%
top_n(n=1)
# write out new dataframe to file system
write_csv(owid_data.total.test.rate,"data/csv/owid_glb_test_rates.csv")
rm(owid_data.total.test.rate)
todays_raw_owid_data <- read_csv(paste0("data/csv/", "owid_testing_raw.csv"))
todays_raw_owid_data <- read_csv(paste0("data/csv/", "owid_testing_raw.csv"))
todays_raw_owid_data %>% filter(location == "United States")
todays_raw_owid_data %>% filter(location == "Belgium")
todays_raw_owid_data %>% filter(location == "Portugal")
todays_raw_owid_data %>% filter(location == "Switzerland")
todays_raw_owid_data %>% filter(location == "Spain")
todays_raw_owid_data %>% filter(location == "Ireland")
todays_raw_owid_data %>% filter(location == "United Kingdom")
check_iso_codes2 <- c("USA","BEL","PRT","CHE","ITA","ESP","IRL","DEU","CAN","RUS","GBR")
owid_data.total.test.rate <-todays_raw_owid_data %>%
filter(!is.na(total_tests_per_thousand) & iso_code %in% check_iso_codes2) %>%
select(iso_code, location, date, total_tests_per_thousand) %>%
group_by(iso_code) %>%
filter(date == max(date)) %>%
top_n(n=1)
View(owid_data.total.test.rate)
write_csv(owid_data.total.test.rate,"data/csv/owid_glb_test_rates.csv")
rm(owid_data.total.test.rate)
total_test_rates.df <- read_csv("data/csv/owid_glb_test_rates.csv")
View(total_test_rates.df)
pUS.2 <- total_test_rates.df[total_test_rates.df$iso_code == "USA","total_tests_per_thousand"] / 1000
View(pUS.2)
total_test_rates.df[total_test_rates.df$iso_code == "USA",]
total_test_rates.df[total_test_rates.df$iso_code == "USA",]$total_tests_per_thousand
pUS.2 <- total_test_rates.df[total_test_rates.df$iso_code == "USA",]$total_tests_per_thousand / 1000
pUS.2 <- total_test_rates.df[total_test_rates.df$iso_code == "USA",]$total_tests_per_thousand / 1000
pPR.2 <- total_test_rates.df[total_test_rates.df$iso_code == "PRT",]$total_tests_per_thousand / 1000
pSP.2 <- total_test_rates.df[total_test_rates.df$iso_code == "ESP",]$total_tests_per_thousand / 1000
pBE.2 <- total_test_rates.df[total_test_rates.df$iso_code == "BEL",]$total_tests_per_thousand / 1000
pIT.2 <- total_test_rates.df[total_test_rates.df$iso_code == "ITA",]$total_tests_per_thousand / 1000
pRU.2 <- total_test_rates.df[total_test_rates.df$iso_code == "RUS",]$total_tests_per_thousand / 1000
pCH.2 <- total_test_rates.df[total_test_rates.df$iso_code == "CHE",]$total_tests_per_thousand / 1000
pDE.2 <- total_test_rates.df[total_test_rates.df$iso_code == "DEU",]$total_tests_per_thousand / 1000
pIR.2 <- total_test_rates.df[total_test_rates.df$iso_code == "IRL",]$total_tests_per_thousand / 1000
pCA.2 <- total_test_rates.df[total_test_rates.df$iso_code == "CAN",]$total_tests_per_thousand / 1000
pUK.2 <- total_test_rates.df[total_test_rates.df$iso_code == "GRB",]$total_tests_per_thousand / 1000
pUS.2 <- total_test_rates.df[total_test_rates.df$iso_code == "USA",]$total_tests_per_thousand / 1000
pPR.2 <- total_test_rates.df[total_test_rates.df$iso_code == "PRT",]$total_tests_per_thousand / 1000
pSP.2 <- total_test_rates.df[total_test_rates.df$iso_code == "ESP",]$total_tests_per_thousand / 1000
pBE.2 <- total_test_rates.df[total_test_rates.df$iso_code == "BEL",]$total_tests_per_thousand / 1000
pIT.2 <- total_test_rates.df[total_test_rates.df$iso_code == "ITA",]$total_tests_per_thousand / 1000
pRU.2 <- total_test_rates.df[total_test_rates.df$iso_code == "RUS",]$total_tests_per_thousand / 1000
pCH.2 <- total_test_rates.df[total_test_rates.df$iso_code == "CHE",]$total_tests_per_thousand / 1000
pDE.2 <- total_test_rates.df[total_test_rates.df$iso_code == "DEU",]$total_tests_per_thousand / 1000
pIR.2 <- total_test_rates.df[total_test_rates.df$iso_code == "IRL",]$total_tests_per_thousand / 1000
pCA.2 <- total_test_rates.df[total_test_rates.df$iso_code == "CAN",]$total_tests_per_thousand / 1000
pUK.2 <- total_test_rates.df[total_test_rates.df$iso_code == "GBR",]$total_tests_per_thousand / 1000
runApp()
?round
runApp()
source("data_downloaders/cpt_downloader.R")
source("data_downloaders/jhu_downloader.R")
source("data_downloaders/jhu_ts_downloader.R")
source("data_downloaders/jhu_ny_ts_downloader.R")
source("data_downloaders/cdc_downloader.R")
source("data_downloaders/owid_downloader.R")
View(owid_data.total.test.rate)
shiny::runApp()
shiny::runApp()
getwd()
shiny::runApp()
runApp()
shiny::runApp()
runApp()
source("data_downloaders/cpt_downloader.R")
source("data_downloaders/jhu_downloader.R")
source("data_downloaders/jhu_ts_downloader.R")
source("data_downloaders/jhu_ny_ts_downloader.R")
source("data_downloaders/cdc_downloader.R")
source("data_downloaders/owid_downloader.R")
View(oowid_data.total.test.rate)
View(owid_data.total.test.rate)
runApp()
runApp()
?format
shiny::runApp()
